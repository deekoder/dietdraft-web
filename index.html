<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DietDraft - Custom Meal Builder</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
</head>
<body>
    <div class="meal-builder-container">
        <header class="page-header">
            <h1 class="display-4 fw-bold text-success">DietDraft</h1>
            <p class="lead">Build your perfect meal, your way</p>
        </header>
        
        <!-- Screen 1: Main Menu (Updated with both options) -->
        <div id="meal-type-screen" class="screen active">
            <h2 class="text-center mb-4">Choose Your Approach</h2>
            
            <!-- Meal Builder Section -->
            <div class="approach-section mb-4">
                <h3 class="text-center mb-3">üèóÔ∏è Build a Meal Step-by-Step</h3>
                <div class="row g-4">
                    <div class="col-6 col-md-3">
                        <div class="meal-type-card" data-meal-type="breakfast">
                            <div class="meal-type-icon">üç≥</div>
                            <h4>Breakfast</h4>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="meal-type-card" data-meal-type="lunch">
                            <div class="meal-type-icon">ü•ó</div>
                            <h4>Lunch</h4>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="meal-type-card" data-meal-type="dinner">
                            <div class="meal-type-icon">üç≤</div>
                            <h4>Dinner</h4>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="meal-type-card" data-meal-type="snack">
                            <div class="meal-type-icon">ü•®</div>
                            <h4>Snack</h4>
                        </div>
                    </div>
                </div>
                
                <div class="text-center mt-4">
                    <p class="text-muted">‚îÄ‚îÄ‚îÄ OR ‚îÄ‚îÄ‚îÄ</p>
                    <button id="voice-button" class="voice-btn">
                        <span>üé§</span> Quick Voice Recipe
                    </button>
                    <p class="text-muted mt-2" style="font-size: 12px;">
                        One-shot voice recipe generation
                    </p>
                </div>
            </div>
            
            <!-- Diet Coach Section -->
            <div class="approach-section">
                <h3 class="text-center mb-3">üçé Talk to Your Diet Coach</h3>
                <div class="text-center">
                    <div class="coach-intro-card mx-auto" style="max-width: 500px;">
                        <div class="card">
                            <div class="card-body">
                                <h5 class="card-title">Personal Nutrition Guidance</h5>
                                <p class="card-text">
                                    Have a conversation with your AI diet coach. Get personalized meal recommendations, 
                                    ingredient substitutions, and nutritional advice.
                                </p>
                                <ul class="text-start mb-3">
                                    <li>Ask questions about nutrition</li>
                                    <li>Get custom meal plans</li>
                                    <li>Find ingredient alternatives</li>
                                    <li>Understand health benefits</li>
                                </ul>
                                <button id="start-diet-coach" class="btn btn-success btn-lg">
                                    <span>üí¨</span> Start Conversation
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- NEW: Diet Coach Screen -->
        <div id="diet-coach-screen" class="screen">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#" id="end-coach-session">DietDraft</a></li>
                    <li class="breadcrumb-item active">Diet Coach</li>
                </ol>
            </nav>
            
            <div class="diet-coach-container">
                <div class="coach-header text-center mb-4">
                    <h2>üçé Your Personal Diet Coach</h2>
                    <p class="text-muted">Have a conversation about nutrition, get recipes, and find solutions</p>
                </div>
                
                <!-- Chat History -->
                <div class="coach-chat-container">
                    <div id="coach-chat-history" class="coach-chat-history">
                        <!-- Messages will be added here dynamically -->
                    </div>
                </div>
                
                <!-- Input Area -->
                <div class="coach-input-area">
                    <div class="row align-items-center">
                        <div class="col-8">
                            <input 
                                type="text" 
                                id="coach-text-input" 
                                class="form-control" 
                                placeholder="Type your message or use voice..."
                                autocomplete="off"
                            >
                        </div>
                        <div class="col-2">
                            <button id="text-coach-button" class="btn btn-success w-100">
                                Send
                            </button>
                        </div>
                        <div class="col-2">
                            <button id="voice-coach-button" class="btn btn-outline-success w-100">
                                üé§
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- End Session Button -->
                <div class="text-center mt-3">
                    <button id="end-coach-session" class="btn btn-outline-secondary btn-sm">
                        End Session
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Screen 2: Template Selection (Existing) -->
        <div id="template-screen" class="screen">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#" id="back-to-meal-types">DietDraft</a></li>
                    <li class="breadcrumb-item active" id="meal-type-breadcrumb">Meal Type</li>
                </ol>
            </nav>
            
            <h2 class="mb-4" id="template-header">Popular Templates</h2>
            
            <div class="row g-4" id="templates-container">
                <!-- Templates will be added dynamically -->
            </div>
        </div>
        
        <!-- Screen 3: Base Selection (Existing) -->
        <div id="base-screen" class="screen">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#" id="back-to-meal-types-from-base">DietDraft</a></li>
                    <li class="breadcrumb-item"><a href="#" id="back-to-templates">Meal Type</a></li>
                    <li class="breadcrumb-item active">Choose Base</li>
                </ol>
            </nav>
            
            <div class="meal-preview-card">
                <img src="https://via.placeholder.com/800x400" alt="Meal Preview" class="meal-preview-img" id="meal-preview-img">
                <div class="meal-preview-details">
                    <h3 id="meal-preview-title">Custom Meal</h3>
                    <div class="meal-preview-selected">
                        <p class="mb-1">Selected so far:</p>
                        <ul id="selected-items-list">
                            <li id="selected-meal-type">Meal type: Dinner</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <h2 class="mb-4">Choose Your Base</h2>
            
            <div class="row g-3" id="base-options-container">
                <!-- Base options will be added dynamically -->
            </div>
            
            <div class="step-navigation">
                <button class="btn btn-outline-secondary step-btn" id="back-from-base">Back</button>
                <button class="btn btn-success step-btn" id="next-from-base">Next Step</button>
            </div>
        </div>
        
        <!-- Screen 4: Protein Selection (Existing) -->
        <div id="protein-screen" class="screen">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#" id="back-to-start-from-protein">DietDraft</a></li>
                    <li class="breadcrumb-item"><a href="#" id="back-to-base-from-protein">Choose Base</a></li>
                    <li class="breadcrumb-item active">Choose Protein</li>
                </ol>
            </nav>
            
            <div class="meal-preview-card">
                <img src="https://via.placeholder.com/800x400" alt="Meal Preview" class="meal-preview-img">
                <div class="meal-preview-details">
                    <h3 id="meal-preview-title-protein">Custom Meal</h3>
                    <div class="meal-preview-selected">
                        <p class="mb-1">Selected so far:</p>
                        <ul id="selected-items-list-protein">
                            <!-- Selected items will be added dynamically -->
                        </ul>
                    </div>
                </div>
            </div>
            
            <h2 class="mb-4">Choose Your Protein</h2>
            
            <div class="row g-3" id="protein-options-container">
                <!-- Protein options will be added dynamically -->
            </div>
            
            <div class="step-navigation">
                <button class="btn btn-outline-secondary step-btn" id="back-from-protein">Back</button>
                <button class="btn btn-success step-btn" id="next-from-protein">Next Step</button>
            </div>
        </div>
        
        <!-- Screen for Final Recipe (Existing) -->
        <div id="final-recipe-screen" class="screen">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#" id="back-to-start">DietDraft</a></li>
                    <li class="breadcrumb-item active">Your Recipe</li>
                </ol>
            </nav>
            
            <div class="card shadow">
                <div class="card-body">
                    <h2 id="final-recipe-title" class="card-title text-center mb-4">Customized Meal</h2>
                    
                    <img id="final-recipe-image" src="https://via.placeholder.com/800x400" alt="Recipe" class="img-fluid rounded mb-4">
                    
                    <div class="row">
                        <!-- LEFT COLUMN: Recipe Details -->
                        <div class="col-md-8">
                            <h4>Ingredients</h4>
                            <ul id="final-ingredients-list" class="mb-4">
                                <!-- Ingredients will be added dynamically -->
                            </ul>
                            
                            <h4>Instructions</h4>
                            <div id="final-instructions" class="mb-4">
                                <!-- Instructions will be added dynamically -->
                            </div>
                            
                            <h4>Nutritional Information</h4>
                            <div id="final-nutrition" class="p-3 bg-light rounded mb-4">
                                <!-- Nutrition info will be added dynamically -->
                            </div>
                        </div>
                        
                        <!-- RIGHT COLUMN: Reasoning Panel -->
                        <div class="col-md-4">
                            <div id="meal-reasoning-container" class="reasoning-panel">
                                <p>Loading nutritional insights...</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="d-flex justify-content-center gap-3 mt-4">
                        <button class="btn btn-outline-secondary" id="start-over-btn">Start Over</button>
                        <button class="btn btn-outline-primary" id="share-btn">Share Recipe</button>
                        <button class="btn btn-success" id="save-btn">Save Recipe</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script type="module" src="js/app.js"></script>
</body>
</html>